<!-- src/app/pages/trilha/trilha.html -->
<div class="trilha-page container-fluid vh-100 p-0 d-flex">
  <!-- Sidebar -->
  <aside class="sidebar d-flex flex-column p-3">
    <h2 class="fw-bold text-white mb-4">MONEVA</h2>
    <ul class="nav flex-column">
      <li class="nav-item mb-2">
        <a class="nav-link text-white" routerLink="/home">ğŸ  Home</a>
      </li>
      <li class="nav-item mb-2">
       <a class="nav-link aside text-white active" routerLink="/trilha">
          ğŸ’° Trilha de Aprendizado
        </a>
      </li>
      <li class="nav-item mb-2">
        <a class="nav-link text-white" routerLink="/demonstrativos">ğŸ“Š Demonstrativos</a>
      </li>
      <li class="nav-item">
        <a class="nav-link text-white" routerLink="/conquistas">ğŸ† Conquistas</a>
      </li>
    </ul>
  </aside>


  <!-- ConteÃºdo principal -->
  <main class="flex-grow-1 p-4 bg-black">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h3 class="fw-semibold text-success">Trilha de Aprendizado</h3>
      <div>
        <button class="btn btn-outline-light btn-sm me-2" (click)="resetTrilha()">Reset</button>
        <button class="btn btn-outline-light btn-sm">Perfil</button>
      </div>
    </div>

    <div class="trilha-container position-relative">
      <!-- linha central -->
      <div class="linha-central" aria-hidden="true"></div>

      <!-- renderizaÃ§Ã£o dos nÃ³s -->
      @for (nodo of nodos; track nodo.id; let i = $index) {
        <div
          id="nodo-{{ i }}"
          class="nodo"
          [class.left]="i % 2 === 0"
          [class.right]="i % 2 !== 0"
          [ngClass]="getNodoClass(nodo)"
          (click)="abrirNodo(i)"
          [routerLink]="nodo.state !== 'locked' ? getNodoRoute(nodo) : null"
        >
          <div
            class="nodo-inner"
            [style.boxShadow]="'0 6px 18px rgba(0,0,0,0.45), 0 0 0 6px ' + (nodo.state === 'done' ? 'rgba(0,192,83,0.12)' : 'transparent')"
          >
            <div class="icone" [style.background]="nodo.color">{{ nodo.emoji }}</div>

            <div class="titulo">
              {{ nodo.title }}
            </div>

            <div class="controls">
              <button
                class="btn small btn-ghost"
                (click)="$event.stopPropagation(); concluirNodo(i)"
              >
                {{ nodo.state === 'done' ? 'ConcluÃ­do' : 'Marcar' }}
              </button>
            </div>
          </div>
        </div>
      }
    </div>

    <div class="mt-5 text-center text-muted small">
      Complete as liÃ§Ãµes para desbloquear a prÃ³xima. Esse layout foi inspirado nas trilhas gamificadas.
    </div>
  </main>
</div>
