<div class="board">
  <!-- Sidebar -->
  <aside class="sidebar d-flex flex-column p-3">
    <h2 class="fw-bold text-white mb-4">MONEVA</h2>
    <ul class="nav flex-column">
      <li class="nav-item mb-2"><a class="nav-link active text-white" routerLink="/home">ğŸ  Home</a></li>
      <li class="nav-item mb-2"><a class="nav-link text-white" routerLink="/trilha">ğŸ’° Trilha de Aprendizado</a></li>
      <li class="nav-item mb-2"><a class="nav-link text-white" routerLink="/demonstrativos">ğŸ“Š Demonstrativos</a></li>
      <li class="nav-item"><a class="nav-link text-white" routerLink="/conquistas">ğŸ† Conquistas</a></li>
    </ul>
  </aside>

  <!-- ConteÃºdo -->
  <main class="main">

    <!-- Header -->
    <header class="home-top">
      <div>
        <h2 class="hello">Fala aÃ­, {{ firstName() }}!</h2>
        <small class="muted">{{ nomeMes() }}</small>
      </div>
    </header>

    <!-- KPIs -->
    <section class="kpis">
      <div class="kcard">
        <div class="khead">ğŸ¯ Metas Financeiras</div>
        <div class="kprogress">
          <div class="fill" [style.width.%]="metaProgresso() * 100"></div>
        </div>
        <small class="muted">
          Economizado: <b>R$ {{ economiaMensal() | number:'1.2-2' }}</b>
          <ng-container *ngIf="goal() as g">
            de <b>R$ {{ g.valorMeta | number:'1.2-2' }}</b>
          </ng-container>
        </small>
      </div>

      <div class="kcard">
        <div class="khead">ğŸ’° Economia do MÃªs</div>
        <div class="big">R$ {{ economiaMensal() | number:'1.2-2' }}</div>
        <small class="muted">Saldo (Entradas âˆ’ SaÃ­das)</small>
      </div>

      <div class="kcard">
        <div class="khead">ğŸ… NÃ­vel Atual</div>
        <div class="kprogress thin">
          <div class="fill" style="width: 45%"></div>
        </div>
        <small class="muted">Conquistas: 27 / 200</small>
      </div>
    </section>

    <!-- Alertas -->
    <section class="alerts" *ngIf="alertas().length">
      <div class="alert" *ngFor="let a of alertas()" [class.med]="a.gravidade==='med'" [class.high]="a.gravidade==='high'">
        <span *ngIf="a.tipo==='categoria'">âš ï¸</span>
        <span *ngIf="a.tipo==='pico'">ğŸ“ˆ</span>
        <span *ngIf="a.tipo==='meta'">ğŸ¯</span>
        <span>{{ a.texto }}</span>
      </div>
    </section>

    <!-- Dashboard -->
    <section class="dashboard">
      <h3>Dashboard Financeiro</h3>

      <!-- Se houver URL do PowerBI, usa iframe. Caso contrÃ¡rio, mostra grÃ¡ficos nativos. -->
      <div *ngIf="powerBiUrl(); else nativeCharts" class="pbi-wrap">
        <iframe [src]="powerBiUrl() | safeUrl" frameborder="0" allowfullscreen></iframe>
      </div>

      <ng-template #nativeCharts>
        <div class="charts">
          <div class="card">
            <h4>Fluxo do MÃªs</h4>
            <canvas id="barChart"></canvas>
          </div>
          <div class="card">
            <h4>Despesas por Categoria</h4>
            <canvas id="donutChart"></canvas>
          </div>
        </div>
      </ng-template>
    </section>

  </main>
</div>
